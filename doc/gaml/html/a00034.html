<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>gaml-1.16: example-004-001-variable-projection.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gaml-1.16
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">example-004-001-variable-projection.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00175.html">gaml.hpp</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;ctime&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;utility&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;numeric&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// This example is about how to use data projections over a subset of</span></div><div class="line"><span class="comment">// attributes.  The example considers the subset of the 4th, 5th and</span></div><div class="line"><span class="comment">// 8th attribute. Projections are used for variable selection (see</span></div><div class="line"><span class="comment">// next examples).</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define DATA_SIZE        10</span></div><div class="line"><span class="preprocessor">#define ATTRIBUTE_NUMBER 10</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> std::array&lt;double, ATTRIBUTE_NUMBER&gt; X;</div><div class="line"><span class="keyword">typedef</span> <span class="keywordtype">bool</span>                                 U;</div><div class="line"><span class="keyword">typedef</span> std::pair&lt;X, U&gt;                      Data;</div><div class="line"><span class="keyword">typedef</span> std::vector&lt;Data&gt;                    DataSet;</div><div class="line"></div><div class="line">DataSet build_dataset() {</div><div class="line">  DataSet dataset;</div><div class="line">  dataset.resize(DATA_SIZE);</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; d : dataset) {</div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; attr : d.first)</div><div class="line">      attr = <a name="a0"></a><a class="code" href="a00220.html#a63a869d5b9fe61b984623e3ecd99a033">gaml::random::uniform</a>(0, 1);</div><div class="line">    d.second = <a name="a1"></a><a class="code" href="a00220.html#a50561031870af4d865de65f89c677916">gaml::random::proba</a>(.5);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> dataset;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> DATASET&gt;</div><div class="line"><span class="keywordtype">void</span> print_dataset(<span class="keyword">const</span> DATASET&amp; dataset) {</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; data : dataset) {</div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; var : data.first)</div><div class="line">      std::cout &lt;&lt; var &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div><div class="line">    <span class="keywordflow">if</span> (data.second)</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;: true&quot;</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;: false&quot;</span> &lt;&lt; std::endl;</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">const</span> X&amp; input_of_data(<span class="keyword">const</span> Data&amp; data) {</div><div class="line">  <span class="keywordflow">return</span> data.first;</div><div class="line">}</div><div class="line"></div><div class="line">U output_of_data(<span class="keyword">const</span> Data&amp; data) {</div><div class="line">  <span class="keywordflow">return</span> data.second;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div><div class="line"></div><div class="line">  <span class="comment">// random seed initialization</span></div><div class="line">  std::srand(std::time(0));</div><div class="line"></div><div class="line">  <span class="comment">// configuration of the printing for numbers.</span></div><div class="line">  std::cout &lt;&lt; std::setiosflags(std::ios::fixed) &lt;&lt; std::setprecision(3);</div><div class="line"></div><div class="line">  DataSet dataset = build_dataset();</div><div class="line"></div><div class="line">  <span class="comment">// The set of indices of variables to select (indices start at 0)</span></div><div class="line">  <span class="keyword">typedef</span> std::array&lt;size_t, 3&gt; Idx;</div><div class="line"></div><div class="line">  Idx indices = { { 3, 4, 8 } };</div><div class="line"></div><div class="line">  <span class="comment">// Creates the projection of a dataset</span></div><div class="line">  <span class="keyword">auto</span> projection = <a name="a2"></a><a class="code" href="a00204.html#a1ddb76665b6c96d816346adde7067e5f">gaml::project</a>(dataset.begin(),  dataset.end(),  <span class="comment">// Range of data</span></div><div class="line">                                  indices.cbegin(), indices.cend(), <span class="comment">// Range of indices</span></div><div class="line">                                  input_of_data, output_of_data);</div><div class="line"></div><div class="line">  <span class="comment">// Outputs the initial dataset</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Initial dataset:&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line">  print_dataset(dataset);</div><div class="line">  std::cout &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="comment">// Outputs the projected dataset</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Projected dataset on variables of index {&quot;</span>;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> attr : indices) std::cout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; attr;</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; }:&quot;</span> &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="comment">// Making a projection implies using internal types, defined by</span></div><div class="line">  <span class="comment">// gaml. They can be manipulated by dedicated type traits, enabling</span></div><div class="line">  <span class="comment">// to retrieve the types.</span></div><div class="line">  <span class="keyword">typedef</span> <a name="_a3"></a><a class="code" href="a00138.html">gaml::projection_traits&lt;X, U, Idx::const_iterator&gt;</a> Traits;</div><div class="line"></div><div class="line">  <span class="keyword">typedef</span> Traits::input_type           Input;          <span class="comment">// This is X here.</span></div><div class="line">  <span class="keyword">typedef</span> Traits::output_type          Output;         <span class="comment">// This is the initial U which is the same before and after projection</span></div><div class="line">  <span class="keyword">typedef</span> Traits::projected_input_type ProjectedInput; <span class="comment">// This is the type of the input after projection (a collection of the projected dimensions)</span></div><div class="line">  <span class="keyword">typedef</span> Traits::projected_data_type  ProjectedData;  <span class="comment">// This is the type of the pair ProjectedInput/Output.</span></div><div class="line">  </div><div class="line">  <span class="keyword">typedef</span> decltype(projection)         Projection;     <span class="comment">// We get the projection type from our &#39;projection&#39; variable.</span></div><div class="line"></div><div class="line">  <span class="comment">// Let us compare the first initial data with the first projected data.</span></div><div class="line">  <span class="comment">// Making types explicit is for clarification purpose. Inference type (auto) could be used instead.</span></div><div class="line">  <span class="keyword">auto</span>&amp; initialData = *(dataset.begin());                       <span class="comment">// Get the first data</span></div><div class="line">  <span class="keyword">const</span> Input&amp; initialInput = input_of_data(initialData); <span class="comment">// Retrieve the input from it.</span></div><div class="line">  <span class="keyword">const</span> Output&amp; initialOutput = output_of_data(initialData); <span class="comment">// Retrieve the output from it.</span></div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;First initial data is (&quot;</span>;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; val : initialInput) std::cout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; val;</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; ), label is &quot;</span> &lt;&lt; initialOutput &lt;&lt; <span class="stringliteral">&quot;, input dimension is &quot;</span> &lt;&lt; initialInput.size() &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> ProjectedData&amp; projectedData   = *(projection.begin());      <span class="comment">// Get the first projected data.</span></div><div class="line">  <span class="keyword">const</span> ProjectedInput&amp; projectedInput  = Projection::inputOf(projectedData);  <span class="comment">// Retrieve the input from it.</span></div><div class="line">  <span class="keyword">const</span> Output&amp; projectedOutput = Projection::outputOf(projectedData); <span class="comment">// Retrieve the output from it.</span></div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;First projected data is (&quot;</span>;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; val : projectedInput) std::cout &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; val;</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot; ), label is &quot;</span> &lt;&lt; projectedOutput &lt;&lt; <span class="stringliteral">&quot;, input dimension is &quot;</span> &lt;&lt; projectedInput.size() &lt;&lt; std::endl &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="comment">// Let us print the whole projected dataset.</span></div><div class="line">  print_dataset(projection);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
